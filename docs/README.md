# Итоговое задание по дисциплине "Базы данных"

## Описание базы

База описывает учебное заведение: студенты, преподаватели, группы, предметы и оценки.

Используется PostgreSQL.

## Таблицы

Всего таблиц: 6

- groups
- students
- teachers
- subjects
- teacher_subjects
- grades

### groups

- group_id – первичный ключ
- group_name – название группы, уникальное
- enrollment_year – год набора
- specialty – специальность

Одна группа может включать много студентов.

### students

- student_id – первичный ключ
- full_name – ФИО студента
- birth_date – дата рождения
- email – уникальный адрес электронной почты
- phone – телефон
- group_id – внешний ключ на groups.group_id

Связь: одна группа → много студентов.

### teachers

- teacher_id – первичный ключ
- full_name – ФИО преподавателя
- birth_date – дата рождения
- email – уникальный адрес электронной почты
- phone – телефон
- department – кафедра / факультет

### subjects

- subject_id – первичный ключ
- title – название предмета, уникальное
- category – тип предмета (например, "математический", "гуманитарный")
- credits – количество часов / кредитов
- description – краткое описание предмета

### teacher_subjects

Связь преподавателей и предметов.

- teacher_id – внешний ключ на teachers.teacher_id
- subject_id – внешний ключ на subjects.subject_id
- assign_year – год, когда преподаватель вел этот предмет
- составной первичный ключ (teacher_id, subject_id)

Через эту таблицу реализуется связь многие ко многим между teachers и subjects.

### grades

Таблица оценок.

- grade_id – первичный ключ
- student_id – внешний ключ на students.student_id
- subject_id – внешний ключ на subjects.subject_id
- teacher_id – внешний ключ на teachers.teacher_id
- grade_value – оценка (от 1 до 5)
- grade_date – дата выставления оценки
- comment – комментарий

Ограничения:

- grade_value имеет ограничение CHECK (grade_value BETWEEN 1 AND 5)
- при удалении студента его оценки удаляются (ON DELETE CASCADE)
- при удалении предмета оценки по нему удаляются (ON DELETE CASCADE)

Итоговые связи:

- студент связан с группой
- преподаватель связан с предметами через teacher_subjects
- таблица grades связывает студента, предмет и преподавателя и хранит оценки

## SQL файлы

- `sql/schema.sql` – структура базы данных: создание таблиц и ограничений.
- `sql/queries.sql` – запросы к базе данных.

В файле `sql/queries.sql` реализованы запросы:

1. Список студентов по определенному предмету.
2. Список предметов, которые преподает конкретный преподаватель.
3. Средний балл студента по всем предметам.
4. Рейтинг преподавателей по средней оценке студентов.
5. Преподаватели, которые вели более 3 предметов за последний год.
6. Студенты со средним баллом выше 4 по математическим предметам и ниже 3 по гуманитарным.
7. Предметы, по которым больше всего двоек в текущем семестре.
8. Студенты, которые получили высший балл по всем экзаменам, и преподаватели, которые вели эти предметы.
9. Изменение среднего балла студента по годам обучения.
10. Группы, в которых средний балл выше по аналогичным предметам.
11. Вставка записи о новом студенте.
12. Обновление контактной информации преподавателя.
13. Удаление записи о предмете, который больше не преподают.
14. Вставка новой записи об оценке студенту.